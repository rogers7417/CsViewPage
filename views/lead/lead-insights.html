<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <title>ì „í™˜ ì¸ì‚¬ì´íŠ¸ ë¦¬í¬íŠ¸</title>

  <!-- Shared styles -->
  <link rel="stylesheet" href="/cs/static/assets/common.css" type="text/css" />

  <style>
    .chart-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      margin-bottom: 28px;
    }

    .chart-card {
      border: 1px solid #e3e6ed;
      border-radius: 8px;
      background: #ffffff;
      padding: 16px;
      box-shadow: 0 1px 2px rgba(40, 49, 71, 0.08);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .chart-card__title {
      margin: 0;
      font-size: 15px;
      font-weight: 600;
      color: #283147;
    }

    .chart-card__meta {
      font-size: 12px;
      color: #67728a;
    }

    .insight-block {
      margin-top: 24px;
    }

    .insight-block__header {
      margin-bottom: 12px;
    }

    .insight-block__title {
      margin: 0;
      font-size: 18px;
      font-weight: 600;
      color: #1f2937;
    }

    .insight-block__desc {
      margin: 4px 0 0;
      font-size: 13px;
      color: #64748b;
    }

    .insight-status {
      margin-bottom: 16px;
      padding: 12px 16px;
      border-radius: 6px;
      background: #f4f6fb;
      color: #2a3451;
      font-size: 14px;
      border: 1px solid #dce2f1;
    }

    .insight-status--error {
      background: #fff5f5;
      border-color: #f6c5c5;
      color: #a42834;
    }

    .insight-status--success {
      background: #f1fcf5;
      border-color: #b8ead0;
      color: #1d6b3a;
    }

    .insight-summary {
      margin-top: 12px;
      padding: 16px 20px;
      border-radius: 6px;
      border: 1px solid #e3e6ed;
      background: #f9fbff;
      line-height: 1.5;
    }

    .insight-summary__title {
      margin: 0 0 12px;
      font-size: 18px;
      font-weight: 700;
      color: #283147;
    }

    .insight-summary__list {
      margin: 0;
      padding-left: 20px;
      color: #42516f;
    }

    .insight-summary__list li {
      margin-bottom: 6px;
    }

    .insight-summary__sublist {
      margin-top: 6px;
      padding-left: 18px;
      color: #4b5b7a;
      font-size: 13px;
    }

    .insight-summary__sublist li {
      margin-bottom: 4px;
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <h1 class="sidebar__title">Salesforce ë¦¬í¬íŠ¸</h1>
      <p class="sidebar__subtitle">Lead ë¶„ì„ ëŒ€ì‹œë³´ë“œ</p>
      <nav class="sidebar__nav">
        <a href="/cs/lead/dashboard">ì›”ê°„ ë¦¬ë“œ í˜„í™©</a>
        <a href="/cs/lead/dashboard/daily">ì¼ìë³„ ë¦¬ë“œ í˜„í™©</a>
        <a href="/cs/lead/insights">ì „í™˜ ì¸ì‚¬ì´íŠ¸</a>
        <a href="/cs/opportunity/kanban">ì˜ì—…ê¸°íšŒ ì¹¸ë°˜</a>
      </nav>
    </aside>

    <main class="content">
      <div class="page-header">
        <h2 class="page-header__title">ì „í™˜ ì¸ì‚¬ì´íŠ¸ ë¦¬í¬íŠ¸</h2>
        <p class="page-header__desc">ì›”ë³„ ì „í™˜ ì§€í‘œì™€ 10ì›” 400ëŒ€ ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ í•„ìš”í•œ ì•¡ì…˜ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”.</p>
      </div>

      <div id="insightStatus" class="insight-status" role="status" aria-live="polite">
        ì¸ì‚¬ì´íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...
      </div>

      <section class="insight-block" aria-labelledby="trend-section-title">
        <div class="insight-block__header">
          <h3 id="trend-section-title" class="insight-block__title">ì›”ë³„ ë³€í™” ë¶„ì„</h3>
          <p class="insight-block__desc">ìµœê·¼ 3ê°œì›” ê°„ ë¦¬ë“œÂ·ì˜ì—…ê¸°íšŒÂ·ê³„ì•½ ë³€í™”ë¥¼ ë¹„êµí•˜ì„¸ìš”.</p>
        </div>

        <div class="chart-grid">
          <section class="chart-card" aria-labelledby="chart-leads-title">
            <h4 id="chart-leads-title" class="chart-card__title">ë¦¬ë“œ ë³€í™”</h4>
            <p class="chart-card__meta">ì›”ë³„ ë¦¬ë“œ ìƒì„± ìˆ˜ëŸ‰</p>
            <canvas id="leadChart" height="180"></canvas>
          </section>

          <section class="chart-card" aria-labelledby="chart-opps-title">
            <h4 id="chart-opps-title" class="chart-card__title">ì˜ì—…ê¸°íšŒ ë³€í™”</h4>
            <p class="chart-card__meta">ì›”ë³„ ì˜ì—…ê¸°íšŒ ìƒì„± ìˆ˜ëŸ‰</p>
            <canvas id="opportunityChart" height="180"></canvas>
          </section>

          <section class="chart-card" aria-labelledby="chart-contracts-title">
            <h4 id="chart-contracts-title" class="chart-card__title">ê³„ì•½ ë³€í™”</h4>
            <p class="chart-card__meta">ì›”ë³„ ê³„ì•½ ì²´ê²° ìˆ˜ëŸ‰</p>
            <canvas id="contractChart" height="180"></canvas>
          </section>
        </div>
      </section>

      <section class="insight-block" aria-labelledby="conversion-section-title">
        <div class="insight-block__header">
          <h3 id="conversion-section-title" class="insight-block__title">ì „í™˜ìœ¨ ë³€í™”</h3>
          <p class="insight-block__desc">ë¦¬ë“œâ†’ê¸°íšŒ, ë¦¬ë“œâ†’ê³„ì•½, ê¸°íšŒâ†’ê³„ì•½ ì „í™˜ìœ¨ì„ ê°ê° ì¶”ì í•˜ì„¸ìš”.</p>
        </div>

        <div class="chart-grid">
          <section class="chart-card" aria-labelledby="chart-conv-lead-opp">
            <h4 id="chart-conv-lead-opp" class="chart-card__title">ë¦¬ë“œâ†’ê¸°íšŒ ì „í™˜ìœ¨</h4>
            <p class="chart-card__meta">ì›”ë³„ ë¦¬ë“œ ëŒ€ë¹„ ê¸°íšŒ ì „í™˜ ë¹„ìœ¨</p>
            <canvas id="conversionLeadOppChart" height="180"></canvas>
          </section>

          <section class="chart-card" aria-labelledby="chart-conv-lead-contract">
            <h4 id="chart-conv-lead-contract" class="chart-card__title">ë¦¬ë“œâ†’ê³„ì•½ ì „í™˜ìœ¨</h4>
            <p class="chart-card__meta">ì›”ë³„ ë¦¬ë“œ ëŒ€ë¹„ ê³„ì•½ ì „í™˜ ë¹„ìœ¨</p>
            <canvas id="conversionLeadContractChart" height="180"></canvas>
          </section>

          <section class="chart-card" aria-labelledby="chart-conv-opp-contract">
            <h4 id="chart-conv-opp-contract" class="chart-card__title">ê¸°íšŒâ†’ê³„ì•½ ì „í™˜ìœ¨</h4>
            <p class="chart-card__meta">ì›”ë³„ ê¸°íšŒ ëŒ€ë¹„ ê³„ì•½ ì „í™˜ ë¹„ìœ¨</p>
            <canvas id="conversionOppContractChart" height="180"></canvas>
          </section>
        </div>
      </section>

      <section class="insight-block" aria-labelledby="performance-section-title">
        <div class="insight-block__header">
          <h3 id="performance-section-title" class="insight-block__title">íŒë§¤ ì„±ê³¼</h3>
          <p class="insight-block__desc">í…Œë¸”ë¦¿ íŒë§¤ ì‹¤ì ê³¼ ê³„ì•½ íš¨ìœ¨ì„ í™•ì¸í•˜ì„¸ìš”.</p>
        </div>

        <div class="chart-grid">
          <section class="chart-card" aria-labelledby="chart-discount-title">
            <h4 id="chart-discount-title" class="chart-card__title">ì´ í• ì¸ ë³€í™”</h4>
            <p class="chart-card__meta">ì›”ë³„ í”„ë¡œëª¨ì…˜/í• ì¸ ê¸ˆì•¡ í•©ê³„</p>
            <canvas id="discountChart" height="180"></canvas>
          </section>

          <section class="chart-card" aria-labelledby="chart-tablet-title">
            <h4 id="chart-tablet-title" class="chart-card__title">í…Œë¸”ë¦¿ íŒë§¤ ë³€í™”</h4>
            <p class="chart-card__meta">ì‹¤ì  vs 10ì›” ëª©í‘œ 400ëŒ€</p>
            <canvas id="tabletChart" height="180"></canvas>
          </section>

          <section class="chart-card" aria-labelledby="chart-efficiency-title">
            <h4 id="chart-efficiency-title" class="chart-card__title">ê³„ì•½ íš¨ìœ¨ì„±</h4>
            <p class="chart-card__meta">ê³„ì•½ë‹¹ í‰ê·  í…Œë¸”ë¦¿ ìˆ˜</p>
            <canvas id="efficiencyChart" height="180"></canvas>
          </section>
        </div>
      </section>

      <section class="insight-summary" aria-labelledby="insight-summary-title">
        <h3 id="insight-summary-title" class="insight-summary__title">10ì›” ëª©í‘œ 400ëŒ€ ë‹¬ì„±ì„ ìœ„í•œ í•µì‹¬ ì•¡ì…˜</h3>
        <ol class="insight-summary__list" id="insight-action-list"></ol>
      </section>

      <section class="insight-summary" aria-labelledby="insight-plan-title">
        <h3 id="insight-plan-title" class="insight-summary__title">í–¥í›„ ì‹¤í–‰ ê³„íš</h3>
        <ul class="insight-summary__list" id="insight-plan-list"></ul>
      </section>
    </main>
  </div>

  <!-- Third-party scripts -->
  <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
  <script src="https://code.jquery.com/ui/1.10.3/jquery-ui.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.6/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>

  <!-- Shared helpers -->
  <script src="/cs/static/assets/gridCommon.js"></script>

  <script>
    (function () {
      if (window.Chart && window.ChartDataLabels) {
        window.Chart.register(window.ChartDataLabels);
      }

      var GC = window.gridCommon || {};
      if (GC.highlightActiveNav) {
        GC.highlightActiveNav(".sidebar__nav");
      }
      var fmt = GC.fmt || function (value) {
        value = Number(value || 0);
        if (isNaN(value)) return "";
        return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      };

      var labelKorean = GC.labelKorean || function (ym) {
        if (!ym) return "";
        var parts = ym.split("-");
        return parts[0] + "ë…„ " + Number(parts[1]) + "ì›”";
      };

      function safeDivide(numerator, denominator) {
        if (!denominator) return 0;
        return numerator / denominator;
      }

      var API_BASE = "/cs";
      var API_ENDPOINT = API_BASE + "/insights/lead-summary";
      var TARGET_TABLETS = 440;

      var FALLBACK_MONTHLY_DATA = [
        { month: "2024-08", leads: 4446, opportunities: 33, contracts: 27, tablets: 355, discount: 820000 },
        { month: "2024-09", leads: 5653, opportunities: 31, contracts: 25, tablets: 512, discount: 1130000 },
        { month: "2024-10", leads: 3484, opportunities: 2, contracts: 0, tablets: 0, discount: 0 }
      ];

      var FALLBACK_SUMMARY = [
        "AI ì¸ì‚¬ì´íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê¸°ë³¸ ìš”ì•½ì„ í™•ì¸í•˜ì„¸ìš”.",
        "8~9ì›” ë¦¬ë“œ ìˆ˜ ëŒ€ë¹„ ì „í™˜ìœ¨ ë³€í™”ë¥¼ ì¬ì ê²€í•˜ê³ , ê³ ì„±ê³¼ ì±„ë„ì„ ìš°ì„  ì§‘ì¤‘í•˜ì„¸ìš”."
      ];

      var FALLBACK_STRATEGIC = [
        {
          title: "â‘  ì „í™˜ìœ¨ ë³µêµ¬",
          bullets: [
            "ë¦¬ë“œ ë¶„ë¥˜ ê¸°ì¤€ê³¼ ì´ˆê¸° ì½œ í”Œë¡œìš°ë¥¼ ì ê²€í•´ ì „í™˜ ì²´ê³„ë¥¼ ì¬ì •ë¹„í•˜ì„¸ìš”.",
            "ì„±ê³¼ ìƒìœ„ ìº í˜ì¸ì„ ë¹ ë¥´ê²Œ ì¬ì§‘ì¤‘í•˜ê³ , ì €ì„±ê³¼ ì±„ë„ì€ ì¶•ì†Œ/ì¤‘ë‹¨ ê²€í† í•˜ì„¸ìš”."
          ]
        },
        {
          title: "â‘¡ ë‹¨ê¸° ê³„ì•½ ê°€ì†",
          bullets: [
            "ì„±ì‚¬ ê°€ëŠ¥ì„± ë†’ì€ ê¸°íšŒì— í• ì¸Â·ì§€ì› íŒ¨í‚¤ì§€ë¥¼ ì œì•ˆí•˜ê³  ì¦‰ì‹œ ëŒ€ì‘í•˜ì„¸ìš”."
          ]
        }
      ];

      var chartInstances = [];

      function registerChart(instance) {
        chartInstances.push(instance);
        return instance;
      }

      function destroyCharts() {
        chartInstances.forEach(function (chart) {
          if (chart && typeof chart.destroy === "function") {
            chart.destroy();
          }
        });
        chartInstances = [];
      }

      function buildCharts(monthlyData) {
        destroyCharts();

        var months = monthlyData.map(function (row) {
          return labelKorean(row.month);
        });

        var leadsSeries = monthlyData.map(function (row) { return row.leads; });
        var opportunitySeries = monthlyData.map(function (row) { return row.opportunities; });
        var contractSeries = monthlyData.map(function (row) { return row.contracts; });
        var discountSeries = monthlyData.map(function (row) {
          var v = row && (row.discount != null ? row.discount : row.totalDiscount);
          return Number.isFinite(Number(v)) ? Number(v) : 0;
        });
        var tabletSeries = monthlyData.map(function (row) { return row.tablets; });
        var conversionSeries = {
          leadToOpportunity: monthlyData.map(function (row) {
            return safeDivide(row.opportunities, row.leads) * 100;
          }),
          leadToContract: monthlyData.map(function (row) {
            return safeDivide(row.contracts, row.leads) * 100;
          }),
          opportunityToContract: monthlyData.map(function (row) {
            return safeDivide(row.contracts, row.opportunities) * 100;
          })
        };
        var efficiencySeries = monthlyData.map(function (row) {
          return safeDivide(row.tablets, row.contracts);
        });
        var tabletTargetSeries = monthlyData.map(function (_, idx) {
          return idx === monthlyData.length - 1 ? TARGET_TABLETS : null;
        });

        function buildSingleBarChart(canvasId, label, data, color) {
          registerChart(new Chart(document.getElementById(canvasId), {
            type: "bar",
            data: {
              labels: months,
              datasets: [
                {
                  label: label,
                  data: data,
                  backgroundColor: color
                }
              ]
            },
            options: {
              responsive: true,
              plugins: {
                legend: { display: false },
                tooltip: { enabled: false },
                datalabels: {
                  anchor: "end",
                  align: "center",
                  offset: 6,
                  color: "#1f2937",
                  font: { size: 12, weight: "600" },
                  formatter: function (value) {
                    return fmt(value);
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: {
                    callback: function (value) { return fmt(value); }
                  }
                }
              }
            }
          }));
        }

        function buildConversionChart(canvasId, label, data, color) {
          registerChart(new Chart(document.getElementById(canvasId), {
            type: "line",
            data: {
              labels: months,
              datasets: [
                {
                  label: label,
                  data: data.map(function (value) {
                    return Number.isFinite(value) ? Number(value.toFixed(2)) : 0;
                  }),
                  borderColor: color,
                  backgroundColor: color.replace("rgb", "rgba").replace(")", ", 0.15)"),
                  tension: 0.35,
                  fill: false,
                  pointRadius: 3,
                  pointHoverRadius: 4
                }
              ]
            },
            options: {
              responsive: true,
              plugins: {
                legend: { display: false },
                tooltip: { enabled: false },
                datalabels: {
                  anchor: "end",
                  align: "center",
                  offset: 6,
                  color: "#1f2937",
                  font: { size: 12, weight: "600" },
                  formatter: function (value) {
                    return Number.isFinite(value) ? value.toFixed(1) + "%" : "";
                  }
                }
              },
              scales: {
                y: {
                  beginAtZero: true,
                  ticks: {
                    callback: function (value) {
                      var out = typeof value === "number" && value.toFixed
                        ? value.toFixed(0)
                        : value;
                      return out + "%";
                    }
                  }
                }
              }
            }
          }));
        }

        buildSingleBarChart("leadChart", "ë¦¬ë“œ", leadsSeries, "rgba(67, 56, 202, 0.55)");
        buildSingleBarChart("opportunityChart", "ì˜ì—…ê¸°íšŒ", opportunitySeries, "rgba(14, 165, 233, 0.6)");
        buildSingleBarChart("contractChart", "ê³„ì•½", contractSeries, "rgba(34, 197, 94, 0.65)");
        buildSingleBarChart("discountChart", "ì´ í• ì¸", discountSeries, "rgba(236, 72, 153, 0.6)");
        buildConversionChart("conversionLeadOppChart", "ë¦¬ë“œâ†’ê¸°íšŒ ì „í™˜ìœ¨", conversionSeries.leadToOpportunity, "rgb(29, 78, 216)");
        buildConversionChart("conversionLeadContractChart", "ë¦¬ë“œâ†’ê³„ì•½ ì „í™˜ìœ¨", conversionSeries.leadToContract, "rgb(22, 163, 74)");
        buildConversionChart("conversionOppContractChart", "ê¸°íšŒâ†’ê³„ì•½ ì „í™˜ìœ¨", conversionSeries.opportunityToContract, "rgb(249, 115, 22)");

        registerChart(new Chart(document.getElementById("tabletChart"), {
          type: "bar",
          data: {
            labels: months,
            datasets: [
              {
                label: "í…Œë¸”ë¦¿ íŒë§¤",
                data: tabletSeries,
                backgroundColor: "rgba(147, 197, 253, 0.75)",
                datalabels: {
                  anchor: "end",
                  align: "end",
                  color: "#1f2937",
                  font: { size: 12, weight: "600" },
                  formatter: function (value) { return fmt(value); }
                }
              },
              {
                label: "ëª©í‘œ",
                data: tabletTargetSeries,
                type: "line",
                borderColor: "#ef4444",
                backgroundColor: "rgba(239, 68, 68, 0.25)",
                borderWidth: 2,
                spanGaps: true,
                tension: 0.2,
                fill: false,
                datalabels: { display: false }
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { position: "bottom" },
              tooltip: { enabled: false },
                datalabels: {
                  anchor: "end",
                  align: "center",
                  offset: 6,
                  color: "#1f2937",
                  font: { size: 12, weight: "600" },
                  formatter: function (value, ctx) {
                    if (ctx.datasetIndex === 0) {
                      return fmt(value);
                  }
                  return "";
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function (value) { return fmt(value); }
                }
              }
            }
          }
        }));

        registerChart(new Chart(document.getElementById("efficiencyChart"), {
          type: "bar",
          data: {
            labels: months,
            datasets: [
              {
                label: "ê³„ì•½ë‹¹ í…Œë¸”ë¦¿",
                data: efficiencySeries.map(function (value) {
                  if (!isFinite(value)) return 0;
                  return Number(value.toFixed(1));
                }),
                backgroundColor: "rgba(59, 130, 246, 0.65)",
                datalabels: {
                  anchor: "end",
                  align: "center",
                  offset: 6,
                  color: "#1f2937",
                  font: { size: 12, weight: "600" },
                  formatter: function (value) { return value.toFixed(1); }
                }
              }
            ]
          },
          options: {
            responsive: true,
            plugins: {
              legend: { display: false },
              tooltip: { enabled: false },
              datalabels: {
                anchor: "end",
                align: "end",
                color: "#1f2937",
                font: { size: 12, weight: "600" },
                formatter: function (value) { return value.toFixed(1); }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function (value) { return value + "ëŒ€"; }
                }
              }
            }
          }
        }));
      }

      function renderSummary(list) {
        var $list = $("#insight-action-list");
        $list.empty();
        var source = Array.isArray(list) && list.length ? list : FALLBACK_SUMMARY;
        source.forEach(function (item) {
          $("<li>").text(item).appendTo($list);
        });
      }

      function renderStrategic(list) {
        var $plan = $("#insight-plan-list");
        $plan.empty();
        var source = Array.isArray(list) && list.length ? list : FALLBACK_STRATEGIC;
        source.forEach(function (item) {
          var title = item.title || "";
          var bullets = Array.isArray(item.bullets) && item.bullets.length
            ? item.bullets
            : (Array.isArray(item.points) ? item.points : []);
          var $item = $("<li>");
          $("<strong>").text("ğŸ”¹ " + title).appendTo($item);
          if (bullets.length) {
            var $sub = $("<ul>").addClass("insight-summary__sublist");
            bullets.forEach(function (text) {
              $("<li>").text(text).appendTo($sub);
            });
            $item.append($sub);
          }
          $plan.append($item);
        });
      }

      function updateStatus(message, type) {
        var $status = $("#insightStatus");
        $status.removeClass("insight-status--error insight-status--success");
        if (type === "error") {
          $status.addClass("insight-status--error");
        } else if (type === "success") {
          $status.addClass("insight-status--success");
        }
        $status.text(message);
      }

      function fetchInsights() {
        return fetch(API_ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            targetTablets: TARGET_TABLETS,
            ownerDept: "ì•„ì›ƒë°”ìš´ë“œì„¸ì¼ì¦ˆ"
          })
        }).then(function (resp) {
          if (!resp.ok) {
            throw new Error("ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: " + resp.status);
          }
          return resp.json();
        });
      }

      function init() {
        updateStatus("ì¸ì‚¬ì´íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...");
        fetchInsights()
          .then(function (payload) {
            var monthlyData = (payload && payload.input && Array.isArray(payload.input.monthlyData))
              ? payload.input.monthlyData
              : FALLBACK_MONTHLY_DATA;

            buildCharts(monthlyData);

            var insight = payload && payload.insight ? payload.insight : null;

            if (insight && Array.isArray(insight.highLevelSummary)) {
              renderSummary(insight.highLevelSummary);
            } else {
              renderSummary(FALLBACK_SUMMARY);
            }

            if (insight && Array.isArray(insight.strategicActions)) {
              renderStrategic(insight.strategicActions);
            } else {
              renderStrategic(FALLBACK_STRATEGIC);
            }

            var outlookComment = insight &&
              insight.currentMonthOutlook &&
              insight.currentMonthOutlook.commentary
              ? insight.currentMonthOutlook.commentary
              : "AI ì¸ì‚¬ì´íŠ¸ ê³„ì‚°ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.";

            updateStatus(outlookComment, "success");
          })
          .catch(function (err) {
            console.error("[lead-insights] AI fetch failed", err);
            buildCharts(FALLBACK_MONTHLY_DATA);
            renderSummary(FALLBACK_SUMMARY);
            renderStrategic(FALLBACK_STRATEGIC);
            updateStatus("AI ì¸ì‚¬ì´íŠ¸ ìƒì„±ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ê¸°ë³¸ ë°ì´í„°ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.", "error");
          });
      }

      init();
    })();
  </script>
</body>
</html>
